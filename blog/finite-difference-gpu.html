<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/code.css">
  <link rel="icon" href="/favicon.ico">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Tasty C++ – Finite-Difference method with GPU | TastyCode</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Tasty C++ – Finite-Difference method with GPU" />
<meta name="author" content="Oleksandr Gituliar" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Crossheck" />
<meta property="og:description" content="Crossheck" />
<link rel="canonical" href="http://localhost:4000/blog/finite-difference-gpu" />
<meta property="og:url" content="http://localhost:4000/blog/finite-difference-gpu" />
<meta property="og:site_name" content="TastyCode" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-09-26T20:17:32+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Tasty C++ – Finite-Difference method with GPU" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Oleksandr Gituliar"},"dateModified":"2023-09-26T20:17:32+02:00","datePublished":"2023-09-26T20:17:32+02:00","description":"Crossheck","headline":"Tasty C++ – Finite-Difference method with GPU","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/finite-difference-gpu"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logo-xl.png"},"name":"Oleksandr Gituliar"},"url":"http://localhost:4000/blog/finite-difference-gpu"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
  <div class="content">
    <nav class="flex justify-between pb-6 text-black">
      <a class="block font-bold my-auto text-2xl tracking-tighter text-inherit" style="text-underline-offset: 6px;"
        href="/">
        <img src="/assets/img/logo.png" class="inline-flex py-4 me-2 w-8"><span class="align-middle">TastyCode</span>
      </a>
      <div class=" my-auto text-xl">
        <a class="text-black" href="/about">About</a>
      </div>
    </nav>

    <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Tasty C++ – Finite-Difference method with GPU</h1>
    <p class="mb-0 post-subtitle flex justify-between">
      <span><time class="dt-published" datetime="2023-09-26T20:17:32+02:00" itemprop="datePublished">
          2023-09-26
        </time>—
        
        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a href="/about" itemprop="name">Oleksandr Gituliar</a></span>
      </span>
      <span>
        <a href="https://twitter.com/OGituliar" target="_blank" title="Twitter" class="social-media">
          <img src="/assets/img/brands/twitter.svg" />
        </a>
        <a href="https://www.linkedin.com/in/gituliar/" target="_blank" title="LinkedIn" class="social-media">
          <img src="/assets/img/brands/linkedin.svg" />
        </a>
        <a href="https://github.com/gituliar" target="_blank" title="GitHub" class="social-media">
          <img src="/assets/img/brands/github.svg" />
        </a>
      </span></p>
  </header>

  <div class="article-body" itemprop="articleBody">
    <h2 id="crossheck">Crossheck</h2>

<p>Obviously, it doesn’t make sense to benchmark the wrong code. To ensure that my code is correct, I
compare the results by pricing a portfolio of 4’495 American put options against a highly-accurate
algorithm of Andersen et al. Its implementation by Klaus Spanderen is available in QuantLib, see his
blog for more details [2]. Thank you Klaus for your contribution!</p>

<p>In fact, this is the same portfolio used in [1], constructed of options by permuting all
combinations of the following parameters (with filtering out options cheaper than 0.5):</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Range</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>k</strong> – strike</td>
      <td>100</td>
    </tr>
    <tr>
      <td><strong>s</strong> – spot</td>
      <td>25, 50, 80, 90, 100, 110, 120, 150, 175, 200</td>
    </tr>
    <tr>
      <td><strong>t</strong> – time to maturity</td>
      <td>1/12, 0.25, 0.5, 0.75, 1.0</td>
    </tr>
    <tr>
      <td><strong>z</strong> – implied volatility</td>
      <td>0.1, 0.2, 0.3, 0.4, 0.5, 0.6</td>
    </tr>
    <tr>
      <td><strong>r</strong> – interest rate</td>
      <td>2%, 4%, 6%, 8%, 10%</td>
    </tr>
    <tr>
      <td><strong>q</strong> – dividend rate</td>
      <td>0%, 4%, 8%, 12%</td>
    </tr>
    <tr>
      <td><strong>w</strong> – parity</td>
      <td>PUT</td>
    </tr>
  </tbody>
</table>

<p>In the table below are the crosscheck results, which contain root-mean-square (RMSE / RRMSE) and
maximum (MAE / MRE) absolute / relative errors.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>CPU x32</th>
      <th>CPU x64</th>
      <th>GPU x32</th>
      <th>GPU x64</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>RMSE</td>
      <td>20.7e-4</td>
      <td>5.4e-4</td>
      <td>15.8e-4</td>
      <td>5.4e-4</td>
    </tr>
    <tr>
      <td>RRMSE</td>
      <td>9.9e-5</td>
      <td>8.1e-5</td>
      <td>9.1e-5</td>
      <td>8.1e-5</td>
    </tr>
    <tr>
      <td>MAE</td>
      <td>23.7e-3</td>
      <td>4.3e-3</td>
      <td>25.1e-3</td>
      <td>4.3e-3</td>
    </tr>
    <tr>
      <td>MRE</td>
      <td>1.1e-3</td>
      <td>1.1e-3</td>
      <td>1.1e-3</td>
      <td>1.1e-3</td>
    </tr>
  </tbody>
</table>

<p>See Andersen et al where they compare the same portfolio with various other methods.</p>

<h2 id="references">References</h2>

<p><a href="https://hpcquantlib.wordpress.com/2022/10/09/high-performance-american-option-pricing">https://hpcquantlib.wordpress.com/2022/10/09/high-performance-american-option-pricing</a> by Klaus
Spanderen</p>

  </div>

  <script src="https://giscus.app/client.js" data-repo="tastycode-dev/tastycode-dev.github.io"
    data-repo-id="R_kgDOKGBktA" data-category="Announcements" data-category-id="DIC_kwDOKGBktM4CYmy8"
    data-mapping="title" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top"
    data-theme="light" data-lang="en" crossorigin="anonymous" async>
    </script>
</article>
  </div>
</body>

</html>